**Определение нужного размера хипа**

**Цель:**

на примере простого приложения понять какое влияние оказывают сборщики мусора

Есть готовое приложение (модуль homework) Запустите его с размером хипа 256 Мб и посмотрите в логе время выполнения.

Пример вывода: spend msec:18284, sec:18

Увеличьте размер хипа до 2Гб, замерьте время выполнения. Результаты запусков записывайте в таблицу. Определите оптимальный размер хипа, т.е. размер, превышение которого, не приводит к сокращению времени выполнения приложения.

**Результаты выполнения домашнего задания**

**Вводные данные:**

**Характеристики ПК:**
Процессор: Intel(R) Core(TM) i5-4460  CPU @ 3.20GHz   3.20 GHz
Оперативная память: 16,0 ГБ

**Параметры Garbage Collector**
Используемый сборщик G1(-XX:+UseG1GC), задавались только параметры изменяющие размер heap: -Xms -Xmx

 1. Heap size = 256 Mb: получаем ошибку
Exception in thread "main" java.lang.OutOfMemoryError: Java heap space
 2. Heap size = 300 Mb: spend msec:20408, sec:20
 3. Heap size = 350 Mb: spend msec:21385, sec:21
 4. Heap size = 400 Mb: spend msec:19200, sec:19
 5. Heap size = 450 Mb: spend msec:17604, sec:17
 6. Heap size = 500 Mb: spend msec:16350, sec:16
 7. Heap size = 700 Mb: spend msec:15572, sec:15
 8. Heap size = 800 Mb:
 9. Heap size = 1024 Mb:
 10. 
| Heap size | Time spend                 |
|-----------|----------------------------|
| 256 Mb    | java.lang.OutOfMemoryError |
| 300 Mb    | spend msec:20408, sec:20   |
| 350 Mb    | spend msec:21385, sec:21   |
| 400 Mb    | spend msec:19200, sec:19   |
| 450 Mb    | spend msec:17604, sec:17   |
| 500 Mb    | spend msec:16350, sec:16   |
| 700 Mb    | spend msec:15572, sec:15   |
| 800 Mb    | spend msec:15461, sec:15   |
| 900 Mb    | spend msec:15206, sec:15   |
| 1024 Mb   | spend msec:14938, sec:14   |
| 1512 Mb   | spend msec:14240, sec:14   |
| 2048 Mb   | spend msec:13912, sec:13   |

**Выводы по оптимизации размера хипа:**
размер хипа влияет на количество сборок мусора, чем больше размер хипа тем меньше количество раз в данном случае запускалось сборок мусора а следовательно меньшее количество раз останавливалась работа приложения
если отталкиваться от минимального времени выполенния то оптимальный размер хипа 2048 Мб т.к. здесь время работы приложения минимально
если считать допустимым время выполнения приложения 15 секунд, то оптимальный размер хипа 700 Мб

**После оптимизации(ru.calculator.optimized):**
 Heap size | Time spend                  |
|-----------|----------------------------|
| 256 Mb    | spend msec:3773, sec:3     |
| 300 Mb    | spend msec:3291, sec:3     |
| 350 Mb    | spend msec:3043, sec:3     |
| 400 Mb    | spend msec:3137, sec:3     |
| 450 Mb    | spend msec:3200, sec:3     |
| 500 Mb    | spend msec:2589, sec:2     |
| 700 Mb    | spend msec:2774, sec:2     |
| 800 Mb    | spend msec:2851, sec:2     |
| 900 Mb    | spend msec:2845, sec:2     |
| 1024 Mb   | spend msec:2913, sec:2     |
| 1512 Mb   | spend msec:2860, sec:2     |
| 2048 Mb   | spend msec:3088, sec:3     |

**Вывод после оптимизации(ru.calculator.optimized):**
после оптимизации приложение стало выполняться в т.ч. на значении хипа 256 мб
при этом на любых значениях хипа время выполения в целом не отличается



